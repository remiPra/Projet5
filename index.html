<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/7.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.1/firebase-messaging.js"></script>
    <!-- For an optimal experience using Cloud Messaging, also add the Firebase SDK for Analytics. -->
    <script src="https://www.gstatic.com/firebasejs/7.2.1/firebase-analytics.js"></script>
    <!-- polices -->
    <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet">

    <!-- integration de la librairie axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.js"></script>
    <!-- librairie aos -->
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.0/dist/aos.css">
    <script src="https://unpkg.com/aos@2.3.0/dist/aos.js"></script>
    <!-- bootstrap -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <!-- integration de vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- integration de font-awesome -->
    <script src="https://kit.fontawesome.com/5a70a7892a.js"></script>
    <link rel="manifest" href="./manifest.json">
    <title>Ma ferme Bio</title>
</head>

<body>
    <div id="app">
        <template>
            <!-- section de l'header comprenant le logo et menu -->
            <header class="d-flex fixed-top justify-content-between">
                <a id="logo" class="pl-4 ">
                    Ma Ferme bio
                </a>
                <nav class="d-flex navbar navbar-light pr-2">
                    <div id="navLargeScreen">
                        <ul class="navbar-nav d-flex flex-row">
                            <li class="nav-items">
                                <a class="nav-link" href="index.html">Accueil</a>
                            </li>
                            <li class="nav-items">
                                <a class="nav-link" href="contact.html">Contact</a>
                            </li>
                            <li class="nav-items">
                                <a class="nav-link" href="sommaireArticle.html">Actualités</a>
                            </li>
                            <li class="nav-items">
                                <a class="nav-link" href="connexion.html">Connexion</a>
                            </li>
                            <li class="nav-items">
                                <a class="nav-link" href="administrationConnexion.html">Administration</a>
                            </li>
                        </ul>
                    </div>
                    <div id="togglecontainer">
                        <button class="navbar-toggler navbar-light toggleMenu" type="button" data-toggle="collapse"
                            data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                            <span class="navbar-toggler-icon text-light"></span>
                        </button>
                        <div id="collapseExample" class="collapse">
                            <div>

                                <a class="nav-link" href="index.html">Accueil</a>

                                <a class="nav-link" href="contact.html">Contact</a>

                                <a class="nav-link" href="sommaireArticle.html">Actualités</a>

                                <a class="nav-link" href="connexion.html">Connexion</a>

                                <a class="nav-link" href="administrationConnexion.html">Administration</a>

                            </div>
                        </div>
                    </div>
                    <div>
                        <button id="btnCart" @click="modal()">
                            <i class="fas fa-shopping-cart">{{numbersOfproducts}}</i>
                        </button>
                    </div>
                </nav>
            </header>
            <div v-if="main">
                <!-- section principale de presentation du shop -->
                <section id="main">
                    <picture id="imageParrallax">
                        <source srcset="assets/images/basket-for-apple-picking-in-fruit-orchard.mobile.jpg"
                            media="(max-width: 480px)">
                        <source srcset="assets/images/basket-for-apple-picking-in-fruit-orchard.Ipad.jpg"
                            media="(max-width: 800px)">
                        <img src="assets/images/basket-for-apple-picking-in-fruit-orchard.jpg"
                            alt="panier en osier se situant sur la gauche dans un champ vert ">
                    </picture>
                    <div id="containerMain" class="row">
                        <main-container></main-container>
                        <slider-news></slider-news>
                    </div>
                </section>
                <!-- section de la partie slider pour la version mobile -->
                <section>
                    <slider-new-mobile></slider-new-mobile>
                </section>
                <!-- section de la partie des infos du magasin -->
                <section class="row">
                    <text-shop></text-shop>
                </section>
                <!-- separation -->
                <section class="separation">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                        <path fill="#26802e" fill-opacity="1"
                            d="M0,224L48,240C96,256,192,288,288,261.3C384,235,480,149,576,112C672,75,768,85,864,101.3C960,117,1056,139,1152,138.7C1248,139,1344,117,1392,106.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                        </path>
                    </svg>
                </section>
                <!-- section de la partie de la categorie des produits -->
                <section id="products">
                    <shop-products></shop-products>
                </section>
                <!-- details des différents produits -->
                <section id="productsList">
                    <shop-products-details 
                    
                        @liveslidenextproduct="liveSlideProductItemNext"
                        @liveslidepreviousproduct="liveSlideProductItemPrevious" @searchproduct="searchProduct"
                        @resetproduct="resetProduct" :elements="productsSelected" @onsubstractcart="substractCart"
                        @onaddcart="addCart" @onselectedcategory="selectedCategory"
                        @onsearchproductchange="changeProductSelected">
                    </shop-products-details>
                </section>
            </div>
            <transition name="fade">
                <section id="overlay" v-if="showModal">
                    <div>
                        <button id="closeModal" @click="closeModal">fermer</button>
                    </div>
                    <cart-product :carts="carts" :showModal="showModal" @onaddcart="addCart"
                        @onsubstractcart="substractCart"></cart-product>
                </section>
            </transition>



            <footer>
                <div class="row introduction">
                    <div class="col-md-4">
                        <h3 class="text-center ">Contactez-Nous</h3>
                        <div>
                            <div>
                                <div>
                                    <i class="fas fa-home"></i>
                                </div>
                                <p>
                                    La ferme Bio <br>

                                    17 rue Alphonse Daudet <br>
                                    82100 OOOOO
                                </p>
                            </div>
                            <i class="fas fa-phone"></i>
                        </div>
                        <p>
                            00000000000
                        </p>
                        <div>
                            <i class="fas fa-phone"></i>
                        </div>
                        <p>
                            xxxxxxxxx@gmail.com
                        </p>

                    </div>
                    <div class="col-md-4">
                        <h3>Horaires d'ouverture</h3>
                        <div>
                            <ul>
                                <li>Lundi: 9h à 18h </li>
                                <li>Mardi: 9h à 18h</li>
                                <li>Mercredi: 9h à 18h</li>
                                <li>Jeudi: 9h à 18h</li>
                                <li>Vendredi: 9h à 18h</li>
                                <li>Samedi: 9h à 18h</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <h3>Réseaux Sociaux</h3>
                        <div>
                            <a href=""><i class="fab fa-facebook"></i></a>
                            <a href=""><i class="fab fa-instagram"></i></a>
                            <a href=""><i class="fab fa-pinterest"></i></a>
                        </div>
                    </div>


                </div>
            </footer>

        </template>
    </div>
    <script>
        // etablissement de composant local
        // vue composant du header
        Vue.component('main-container', {
            data() {
                return {
                    header: {
                        h1: "Bienvenue chez ma ferme Bio",
                        h2: "Votre magasin de fruits et legumes avec la possibilité de commander en ligne",

                    },
                }
            },
            methods: {
                scrolling(element) {
                    document.getElementById(element).scrollIntoView(
                        {
                            block: 'start',
                            behavior: 'smooth',
                        }
                    )
                },
            },
            template: `
            <div class="col-sm-6 container text-center" id="presentationShop">
                <div class="container px-md-3 shopTitle">
                    <h1 class="text-light">{{header.h1}}</h1>
                    <h2>{{header.h2}} </h2>
                    
                    <button id="headerButton" @click="scrolling('goShop')">Commencez vos courses</button>
                </div>
            </div>`
        })
        // vue composant des infos de slider 
        Vue.component('slider-news', {
            data() {
                return {
                    liveSlide: 0,
                    marginLeft: "",
                    slides: [
                        {
                            title: "Promotion de 50%",
                            paragraphe: "du lundi 30 Janvier au samedi 27 Janvier , nous vous proposons un grand stock de cerises a 50%"
                        },
                        { title: "title2", paragraphe: "title2" },
                        { title: "title3", paragraphe: "title2" },
                        { title: "title4", paragraphe: "title2" },
                    ]
                }
            },
            template: `<div class="col-sm-6" id="sliderNews">
                <div class="carroussel">
                    <div class="carrousselcontainer" :style="{marginLeft : marginLeft}">
                        <div class="slideNews" v-for="slide in slides">
                            <h3>{{slide.title}}</h3>
                            <p>{{slide.paragraphe}}</p>

                        </div>
                    </div>
                </div>
                <div class="buttoncontainer">
                    <button v-on:click="previous()"><i class="fas fa-chevron-circle-left"></i>News</button>
                    <button v-on:click="next()"><i class="fas fa-chevron-circle-right"></i>News</button>
                </div>
            </div>`,
            methods: {
                next() {
                    if (this.liveSlide === 3) {
                        this.liveSlide = 0
                    } else { this.liveSlide++; }
                    console.log(this.liveSlide);

                    this.marginLeft = - this.liveSlide * 300 + "px";
                },
                previous() {
                    if (this.liveSlide === 0) {
                        this.liveSlide = this.slides.length - 1
                    } else { this.liveSlide--; }
                    console.log(this.liveSlide);

                    this.marginLeft = - this.liveSlide * 300 + "px";
                }
            },
            computed: {
                slideLength: function () {
                    return this.slides.length
                }
            },
        })
        // vue composant pour l version mobile
        Vue.component('slider-new-mobile', {
            data() {
                return {
                    liveSlide: 0,
                    marginLeft: "",
                    slides: [
                        {
                            title: "Promotion de 50%",
                            paragraphe: "du lundi 30 Janvier au samedi 27 Janvier , nous vous proposons un grand stock de cerises a 50%"
                        },
                        { title: "title2", paragraphe: "title2" },
                        { title: "title3", paragraphe: "title2" },
                        { title: "title4", paragraphe: "title2" },
                    ]
                }
            },
            template: `
            <div class="col-md-6" id="sliderNewsMobile">
                <div class="carroussel">
                    <div class="carrousselcontainer" :style="{marginLeft : marginLeft}">
                        <div class="slideNews" v-for="slide in slides">
                            <h3>{{slide.title}}</h3>
                            <p>{{slide.paragraphe}}</p>
                        </div>
                    </div>
                </div>
                <div class="buttoncontainer">
                    <button v-on:click="previous()"><i class="fas fa-chevron-circle-left"></i>News</button>
                    <button v-on:click="next()"><i class="fas fa-chevron-circle-right"></i>News</button>
                </div>
            </div>`,
            methods: {
                next() {
                    if (this.liveSlide === 3) {
                        this.liveSlide = 0
                    } else { this.liveSlide++; }
                    console.log(this.liveSlide);

                    this.marginLeft = - this.liveSlide * 300 + "px";
                },
                previous() {
                    if (this.liveSlide === 0) {
                        this.liveSlide = this.slides.length - 1
                    } else { this.liveSlide--; }
                    console.log(this.liveSlide);

                    this.marginLeft = - this.liveSlide * 300 + "px";
                }
            },
            computed: {
                slideLength: function () {
                    return this.slides.length
                }
            },

        })

        // vue composant de la presentation du site 
        Vue.component('text-shop', {
            data() {
                return {
                    h2: "Ma ferme bio : un magasin a votre service",
                    IntroTextShop: "Ma ferme bio vous propose un nouveau service pour faciliter vos courses : le Click and Collect",
                    goals: [
                        {
                            h3: "Choisissez tranquillement vos articles de votre magasin sur le site !!",
                            icon: "fas fa-carrot"
                        },
                        {
                            h3: "Acheter vos produits directement en ligne",
                            icon: "fas fa-apple-alt"
                        },
                        {
                            h3: `Vous avez ensuite deux possibilités :
                                    soit cherchez votre commande en magasin ou soit vous faire livrer `,
                            icon: "fas fa-lemon"
                        },
                    ]
                }
            },
            template: `
        <div id="textShop" >
            <div class="introduction col-lg-8 col-xm-10 text-center m-auto">
                <h2 class="p-2">{{h2}}</h2>
                <p>{{IntroTextShop}}</p>
            </div>
            <div class="d-flex flex-wrap container-fluid">
                <div id="goals" class="col-md-7 m-auto">
                    <div id="goalContainer">
                        <div v-for="text in goals" class="d-flex goalsItems">
                            <i :class="text.icon"></i><h3>{{text.h3}}</h3>
                        </div>
                    </div>    
                </div>
                <div class="col-md-5">
                    <!-- mise en place du carroussel de news -->
                    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                        </ol>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img class="d-block w-100"
                                    src="./assets/images/sliderBoutique/a-man-stands-at-the-counter-of-a-coffee-shop.jpg"
                                    alt="un homme qui se tient derrier le cointoir d'une boutique">
                            </div>
                            <div class="carousel-item">
                                <img class="d-block w-100" src="./assets/images/sliderBoutique/a-woman-in-her-shop.jpg"
                                    alt="une vedeuse se tenant de debout a la caisse">
                            </div>
                            <div class="carousel-item">
                                <img class="d-block w-100" src="./assets/images/sliderBoutique/products-are-paid.jpg"
                                    alt="transaction dans un magasin entre le client et la vendeuse">
                            </div>
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
            </div> 
            `,
        })

        // vue composant par catégories 
        Vue.component('shop-products', {
            data() {
                return {
                    h2: "Faites vos courses en ligne",
                    IntroTextShop: "Ajouter le type de produits que vous désirez et vous déciderez ensuite en cliquant sur le petit panier en haut à droite la quantité désirez",
                    goals: [
                        {
                            h3: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do",
                            icon: ""
                        },
                        {
                            h3: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do",
                            icon: ""
                        },
                        {
                            h3: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do",
                            icon: ""
                        },
                    ]
                }
            },
            template: `
    <div>
        <div class="introduction col-lg-8 col-xm-10 text-center m-auto">
            <h2 class="p-2">{{h2}}</h2>
            <p>{{IntroTextShop}}</p>
        </div>
        <div class="col-lg-10 col-md-12 m-auto categoryContainer row">

            <div class="box">
                <div class="imgBx">
                    <img src="assets/images/category/fresh-vegetables-flatlay.jpg">
                </div>
                <div class="content">
                    <h2>Title</h2>
                    <p class="cardColor">Cliquez ici</p>
                    <p class="contentShow">Cliquez sur le bouton pour pouvoir decouvrir nos différents produits disponible en magasin</p>
                    <button href="#">Read More</button>
                    
                </div>
            </div>
            <div class="box">
                <div class="imgBx">
                    <img src="assets/images/category/vertical-citrus-fruit-pile.jpg">
                </div>
                <div class="content">
                    <h2>Panier garni</h2>
                    <p class="cardColor">Cliquez ici</p>
                    <p class="contentShow">Votre magasin vous propose une selection de produits choisis dans ce panier garni.</p>
                    <button href="#">Read More</button>
                </div>
            </div>
        </div>
    </div>`        })


        // vue composant des differents produits 
        Vue.component('shop-products-details', {
            props: ["elements"],
            data() {
                return {
                    category: [{ name: "all" }, { name: "legumes" }, { name: "fruits" }],
                    h2: "Nos légumes",
                    text: "Retouvez la selection de nos plus beaux légumes disponible dans notre magasin",
                    searchProduct: "",
                    productsListShow: true,
                    liveCategory: 0,
                    error: "",
                    //on garde le total du depart
                    searchClass: "displayFlex"
                }
            },
            template: `
        <div id="goShop">
        <div class="introduction col-lg-8 col-xm-10 text-center m-auto">
            <h2 class="p-2">{{h2}}</h2>
            <h3>{{text}}</h3>   
            <p>Parourez les categories</p>    
           <div class="pb-3">
                <button @click="liveCategoryPrevious"><i class="fas fa-chevron-circle-left"></i></button>            
                <button class="buttonBrown w-50" >{{category[liveCategory].name}}</button>
                <button @click="liveCategoryNext"><i class="fas fa-chevron-circle-right"></i></button>
            </div>
            
            <div class="m-auto containerInput" :class="searchClass" >
            <input  id="searchInput" type="text" v-model="searchProduct" @keyup="search">
            <div><i class="fas fa-search"></i></div>
            </div>
        </div>
        <div class="justify-content-flex-start flex-wrap categoryContainer productListGrid">
            <div class="ProductImage text-center box" v-for="(product,index) in elements.productList" :key="product.name"
                :id="product.title" :class="product.visible">
                <div class="imgBx">
                    <img :src="product.src">
                </div>
                <div class="content">
                    <h3>{{product.title}}</h3>
                    <p class="contentShow"> {{product.typeOfQuantity}} <br>{{product.priceDetail}}</p>
                    
                    <p class=" cardColor"> cliquez pour selectionner</p>
                      
                    <div class="d-flex m-auto buttonShop">
                            <button   @click="onAddCart(product)" id="buttonAdd">+</button>
                            <p class="contentShow" id="contentQuantity">{{product.quantityCartProduct}}</p>
                            <button  @click="onSubstractCart(product)" id="buttonAdd">-</button>
                    </div>
                    
                    
                </div>
            </div>    
        </div>
        
            <div class="justify-content-flex-start flex-wrap categoryContainer cartSlider">
                <div id="previousProduct">
                    <button @click="previousProduct"><i class="fas fa-chevron-circle-left"></i> </button>
                </div>

                <div class="ProductImage text-center box" :class="elements.productList[elements.liveSlideProductItem].visible"
                    :id="elements.productList[elements.liveSlideProductItem].title">
                    <div class="imgBx">
                        <img :src="elements.productList[elements.liveSlideProductItem].src">
                    </div>
                    <div class="content">
                        <h3>{{elements.productList[elements.liveSlideProductItem].title}}</h3>
                        <p class="contentShow"> {{elements.productList[elements.liveSlideProductItem].typeOfQuantity}}
                            <br>{{elements.productList[elements.liveSlideProductItem].priceDetail}}</p>
                        <div class="d-flex m-auto buttonShop">
                            <button @click="onAddCart(elements.productList[elements.liveSlideProductItem])" id="buttonAdd">+</button>
                            <p class="contentShow" id="contentQuantity">{{elements.productList[elements.liveSlideProductItem].quantityCartProduct}}</p>
                            <button @click="onSubstractCart(elements.productList[elements.liveSlideProductItem])" id="buttonAdd">-</button>
                        </div>
                        <p class="contentShow">{{elements.productList[elements.liveSlideProductItem].quantityCart}}</p>
                        <p class="cardColor">Cliquez pour ajouter</p>
                        <p id="messageShowAddProduct">{{elements.productList[elements.liveSlideProductItem].title}} ajouté</p>

                    </div>
                </div>


                <div id="nextProduct">
                    <button @click="nextProduct"><i class="fas fa-chevron-circle-right"></i></button>
                </div>
            </div>
        </div>

        
           
            
        
        </div>`,
            methods: {
                search() {
                    console.log(this.searchProduct)
                    this.$emit("searchproduct", this.searchProduct)
                },
                liveCategoryPrevious() {
                    this.$emit("resetproduct")
                    
                    this.searchProduct = "";
                    console.log(this.elements)
                    if (this.liveCategory == 0) {
                        this.liveCategory = this.category.length - 1
                    } else {
                        this.liveCategory--
                    }
                    console.log(this.liveCategory)
                    // if(this.category[this.liveCategory].name =="all") {
                    //     this.searchClass ="displayFlex"
                    // } else {
                    // this.searchClass = "displayNone"
                    // }
                    this.onSelectedCategory(this.category[this.liveCategory].name)

                },
                liveCategoryNext() {
                    this.$emit("resetproduct")
                    this.searchProduct = ""
                    console.log(this.elements)
                    // this.fullElements.forEach(element => {
                    //     document.getElementById(element.title).style.display = "block"
                    // })
                    if (this.liveCategory == this.category.length - 1) {
                        this.liveCategory = 0
                    } else {
                        this.liveCategory++
                    }
                    console.log(this.liveCategory)

                    // if(this.category[this.liveCategory].name =="all") {
                    //     this.searchClass ="displayFlex"
                    // } else {
                    // this.searchClass = "displayNone"
                    // }
                    this.onSelectedCategory(this.category[this.liveCategory].name)
                },
                //evenment de selection de category vers parent

                onSelectedCategory(category) {
                    this.searchProduct = "";
                    this.elements.productList.forEach(element => {
                        document.getElementById(element.title).style.display = "block"
                    })
                    console.log(this.category[this.liveCategory].name)
                    this.$emit("onselectedcategory", category);
                    console.log(category)
                },
                onAddCart(product) {
                    //document.getElementById('messageShowAddProduct').style.animation = "showMessage 4s"
                    this.$emit("onaddcart", product);
                    console.log(product)
                },
                onSubstractCart(product) {
                    this.$emit('onsubstractcart', product)
                },

                nextProduct() {
                    this.$emit("liveslidenextproduct")
                },
                previousProduct() {
                    this.$emit("liveslidepreviousproduct")

                },

            }
        })


        Vue.component('cart-product', {
            template:
                `
    <div>     
        <div>
            <div class="form-group">
                <h3>Votre Panier </h3>
            </div>
        </div>
        <form id="cart" class="col-md-8 text-light"  method="POST">
        <div>
            <div class="form-group">
                <h3>Votre Panier </h3>
            </div>
        </div>
            <template v-if='this.carts==""''>
            <div class="d-flex" >
                <div id="formCart" class="form-group">
                Vous n'avez pas d'articles dans votre panier
                </div>
            </div>    
            </template>
        <div id="containerCart">
        <div class="from-group">
            
        </div>
        <div class="form-group" v-for="(cart,index) in carts">
            <div class="align-items-center" >
                <div class="form-group">
                    <label for="productName">
                    <input type="text" :value="cart.title"  name="productName" id="productName">
                    </label>
                </div>
                <div id="formCart" class="form-group">

                    <label for="productQuantity">
                    <button type="button" @click="onAddCart(cart)">+</button>
                    <input type="text" :value="cart.quantity" name="productQuantity" id="productQuantity">
                    <button type="button" @click="onSubstractQuantity(cart)">-</button>
                    </label>

                    <label for="priceProduct">
                    <input type="text" :value="cart.totalPriceProduct"  name="totalPriceProduct" id="totalPriceProduct">
                    </label>
                    
                </div>
               
                <div class="form-group">
                    
                </div>

            </div>    
        </div>    
        </div>
        <div class="form-group">
            <input class="formButton" @click="confirmationShow" type="button" value="Passez la commande" name="btnContact">
        </div>
        <div id="confirmationModal" v-if="confirmationModal">
            <div class="form-group">
                <h3>Voulez vous confirmez votre choix?</h3>
                <button><a href="etape.html">Oui</a></button>  
                <button @click="confirmationModal=false">Non</button>  
            </div>
        </div>
        </form>
    </div>
    `,
            props: ['carts'],
            data() {
                return {
                    confirmationModal: false
                }
            },
            methods: {
                onAddCart(cart) {
                    console.log(cart);
                    this.$emit('onaddcart', cart)
                },
                onSubstractQuantity(cart) {
                    this.$emit('onsubstractcart', cart)
                },
                confirmationShow() {
                    this.confirmationModal = true;
                    console.log(this.confirmationModal)
                }
            }
        })






        // vue principale 
        let app = new Vue({
            el: "#app",
            data: {
                main: true,
                //confirmation du cart
                showModal: false,
                duplicateCart: false,
                products:{
                    productList:[],
                    liveSlideProductItem: "0"
                },
                productsSelected: {},
                memory:[],
                carts: [],
                quantityCart: ""
            },
            mounted:function(){
                this.getAllProducts()
               

                this.products.liveSlideProductItem = 0
                this.productsSelected = this.products
                if (JSON.parse(localStorage.getItem("carts")).length != 0) {
                    //recuperation du local storage
                    console.log(localStorage.getItem("carts").length)
                    let storageInit = JSON.parse(localStorage.getItem("carts"));
                    this.carts = storageInit;
                    this.carts.forEach(cart => {
                        this.products.productList.forEach(product => {
                            if (product.title == cart.title) {
                                product.quantityCartProduct = cart.quantity
                            }
                        })
                    })
                    this.productsSelected = this.products
                    console.log(this.productsSelected)
                    console.log(this.carts);
                    this.modal()
                }
                else {
                    this.productsSelected = this.products
                    this.carts = []
                }
            },
            methods: {
                //methode pour recuperer les produits
                getAllProducts() {
                    console.log("users")
                    axios.get("proceed.php?action=getAllProducts").then(function (response) {
                        if (response.data.error) {
                            app.errorMsg = response.data.message;
                            console.log(app.errorMsg)
                        }
                        else {
                            console.log(response.data);
                            app.products.productList=response.data
                            app.memory=response.data
                            console.log(app.products)
                            console.log("success");
                        }
                    });
                },
                searchProduct(data) {

                    // on cré un tableau avec tous les noms des produits
                    let products = this.products.productList;
                    // products.forEach(element => {
                    //     sentence.push(element.title)
                    // });


                    let Word = data
                    //passage en minuscule
                    let word = Word.toLowerCase()
                    this.productsSelected.productList.forEach(element => {
                        // si la chaine inclut un des mots
                        if (element.title.includes(word)) {
                            element.visible = "displayFlex"
                            console.log(element)
                            //this.$emit("onsearchproductchange",element)
                            this.productsSelected.liveSlideProductItem = this.productsSelected.productList.indexOf(element);
                            console.log(this.products.liveSlideProductItem)
                            console.log("succes")
                        } else {
                            element.visible = "displayNone"
                            console.log("alert")
                        }
                    })
                },
                addCart(cart) {
                    //verification si le produit existe deja
                    this.carts.forEach(element => {
                        if (element.title == cart.title) {
                            element.quantity++;
                            this.products.productList.forEach(product => {
                                if (product.title == element.title) {
                                    product.quantityCartProduct = element.quantity
                                }
                            })
                            element.totalPriceProduct = element.quantity * element.price
                            this.duplicateCart = true
                        }
                    })
                    //si il est deja present on ne le rajoute pas
                    if (!this.duplicateCart) {
                        this.products.productList.forEach(product => {
                            if (product.title == cart.title) {
                                product.quantityCartProduct = 1
                            }
                        })
                        this.carts.push(cart)

                    }
                    console.log(this.carts);
                    //on reinitialise le dupliateCart en false
                    this.duplicateCart = false;
                    localStorage.setItem("carts", JSON.stringify(this.carts));
                    let storage = JSON.parse(localStorage.getItem("carts"));
                    console.log(storage.length);
                },
                substractCart(cart) {
                    // verification que le produit est present
                    this.carts.forEach(element => {
                        if (element.title == cart.title) {
                            element.quantity--;
                            this.products.productList.forEach(product => {
                                if (product.title == element.title) {
                                    product.quantityCartProduct = element.quantity
                                    console.log(product.quantityCartProduct)
                                }
                            })
                            //si quantity 0
                            if (element.quantity == 0) {
                                const deleteCart = this.carts.indexOf(element);
                                this.carts.splice(deleteCart, 1);
                                console.log(this.carts);
                                return;
                            }
                            element.totalPriceProduct = element.quantity * element.price
                        }
                    })
                    localStorage.setItem("carts", JSON.stringify(this.carts));
                    let storage = JSON.parse(localStorage.getItem("carts"));
                    console.log(storage);
                },
                modal() {
                    this.main = false;
                    this.showModal = true;
                    console.log("true");
                    window.scrollTo(0, 0);
                },
                liveSlideProductItemNext() {
                    let numberOfFrames = 0
                    this.productsSelected.productList.forEach(
                        element => {if(element.visible == "displayFlex"){
                            numberOfFrames++
                            }
                        }
                    )
                    console.log(numberOfFrames)
                    if (this.productsSelected.liveSlideProductItem ==numberOfFrames - 1) {
                        this.productsSelected.liveSlideProductItem = 0
                    } else {
                        this.productsSelected.liveSlideProductItem++
                    }

                },
                liveSlideProductItemPrevious() {
                    if (this.productsSelected.liveSlideProductItem == 0) {
                        this.productsSelected.liveSlideProductItem = this.productsSelected.productList.length - 1
                    } else {
                        this.productsSelected.liveSlideProductItem--
                    };
                    console.log(this.productsSelected.liveSlideProductItem)
                },
                resetProduct() {
                    console.log("resetproducts")
                    this.productsSelected.productList = this.products.productList
                    console.log(this.products.productList)
                    this.productsSelected.productList.forEach(element =>
                        element.visible = "displayFlex"
                    )
                    this.productsSelected.liveSlideProductItem = 0
                    console.log("resetproduct")
                },
                changeProductSelected(data) {
                    console.log(data)
                    this.productsSelected.productList = data
                    console.log(this.productsSelected)
                },
                closeModal() {
                    this.showModal = false;
                    this.main = true;
                    console.log(this.showModal)
                },
                //fonction pour les categories
                selectedCategory(data) {
                    console.log(data)
                    this.productsSelected.productList = [...this.products.productList];
                    console.log(this.productsSelected.productList);
                    console.log(this.products.productList);
                    if (data == "all") {
                        this.productsSelected.productList = this.memory
                    } else {
                        let category = []
                        this.memory.forEach(element => {
                            if (element.category == data) {
                                category.push(element)
                                console.log(element)
                            }
                        })
                            console.log(category)
                            this.productsSelected.productList = category
                            console.log(this.products.productList)
                            //this.productsSelected.productList = category
                    }
                }

            },
            computed: {
                numbersOfproducts() {
                    if (this.carts == null) { return 0 };
                    const numberArticles = this.carts.reduce((acc, curr) => {
                        return acc + curr.quantity;
                    }, 0);
                    return numberArticles;
                },
                totalPriceCart() {
                    const totalPrice = this.carts.reduce((acc, curr) => {
                        return acc + curr.totalPriceProduct;
                    }, 0);
                    console.log(totalPrice)
                    return totalPrice;
                }
            }
        })

        //firebase config
        var config = {
            apiKey: "AIzaSyACBEl4RcIkJB7oy5X-zrOAcECPDvTH4hw",
            authDomain: "simply-notify-68b52.firebaseapp.com",
            databaseURL: "https://simply-notify-68b52.firebaseio.com",
            projectId: "simply-notify-68b52",
            storageBucket: "simply-notify-68b52.appspot.com",
            messagingSenderId: "838544611655",
            appId: "1:838544611655:web:ac89b5c2177b35eb8b1462",
            measurementId: "G-X58YBQG1EB"
        };
        firebase.initializeApp(config);

        const messaging = firebase.messaging();
        messaging
            .requestPermission()
            .then(function () {
                // MsgElem.innerHTML = "Notification permission granted."
                console.log("Notification permission granted.");

                // get the token in the form of promise
                return messaging.getToken()
            })
            .then(function (token) {
                // TokenElem.innerHTML = "token is : " + token
                console.log(token)
            })
            .catch(function (err) {
                //ErrElem.innerHTML = ErrElem.innerHTML + "; " + err
                console.log("Unable to get permission to notify.", err);
            });
        console.log(navigator)
        messaging.onMessage(function (payload) {
            console.log("Message received. ", payload);
            const { title, ...options } = payload.notification;
            let titleR = payload.notification.title;
            let optionsR = {
                body: payload.notification.body,

            }
            new Notification(titleR, optionsR)

            navigator.serviceWorker.ready.then(registration => {
                console.log(registration)
                return registration.showNotification(title, options);
            });

        });



    </script>

</body>


</html>